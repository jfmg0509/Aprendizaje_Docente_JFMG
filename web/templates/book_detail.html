{{define "book_detail"}}
<h1>Detalle del libro</h1>

<style>
  .card{
    border:1px solid #E6EAF2;
    border-radius:18px;
    padding:22px;
    margin-bottom:18px;
    background:#fff;
  }
  .grid2{
    display:grid;
    grid-template-columns: 1fr 1fr;
    gap:18px;
  }
  label{display:block; margin:10px 0 6px; color:#111827;}
  input, select{
    width:100%;
    padding:10px 12px;
    border:1px solid #E6EAF2;
    border-radius:12px;
    font:inherit;
    outline:none;
  }
  button{
    margin-top:12px;
    padding:10px 14px;
    border:1px solid #E6EAF2;
    border-radius:12px;
    background:#fff;
    cursor:pointer;
  }
  button:hover{background:#F8FAFF;}
  ul{margin:0; padding-left:18px;}
  .muted{color:#6B7280; font-weight:300;}
</style>

<div class="card">
  <div><b>ID:</b> {{.Book.ID}}</div><br/>
  <div><b>Título:</b> {{.Book.Title}}</div><br/>
  <div><b>Autor:</b> {{.Book.Author}}</div><br/>
  <div><b>Año:</b> {{.Book.Year}}</div><br/>
  <div><b>ISBN:</b> {{.Book.ISBN}}</div><br/>
  <div><b>Categoría:</b> {{.Book.Category}}</div><br/>
  <div><b>Tags:</b> {{.Book.Tags}}</div><br/>
  <div><b>Descripción:</b> {{.Book.Description}}</div>
</div>

<div class="grid2">
  <div class="card">
    <h2 style="margin-top:0;">Registrar acceso</h2>

    <form method="POST" action="/ui/access">
      <input type="hidden" name="book_id" value="{{.Book.ID}}"/>

      <label>User ID</label>
      <input name="user_id" placeholder="Ej: 1" autocomplete="off"/>

      <label>Tipo de acceso</label>
      <select name="access_type">
        {{range .AccessTypes}}
          <option value="{{.}}">{{.}}</option>
        {{end}}
      </select>

      <button type="submit">Registrar</button>
    </form>

    <p class="muted" style="margin-top:12px;">
      Se registra en cola (channel) y se inserta asíncronamente.
      Si no ves el conteo al instante, espera 1–2 segundos y refresca manualmente.
    </p>
  </div>

  <div class="card">
    <h2 style="margin-top:0;">Estadísticas</h2>

    <ul>
      {{range .AccessTypes}}
        <li>{{.}}: {{index $.Stats .}}</li>
      {{end}}
    </ul>
  </div>
</div>
{{end}}
